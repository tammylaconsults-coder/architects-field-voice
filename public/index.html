<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Unified Field Voice</title>
</head>
<body>
  <h1>Unified Field Voice</h1>

  <div id="conversation" style="border:1px solid #ccc; padding:10px; width:400px; height:300px; overflow-y:auto;">
    <p><em>Conversation will appear here...</em></p>
  </div>

  <input id="userInput" type="text" placeholder="Type your message" style="width:300px;"/>
  <button id="sendBtn">Send</button>
  <button id="micBtn">ðŸŽ¤ Speak</button>

  <script>
    const conversationDiv = document.getElementById("conversation");
    const userInput = document.getElementById("userInput");
    const sendBtn = document.getElementById("sendBtn");
    const micBtn = document.getElementById("micBtn");

    // âœ… Update this to your Render backend URL
    const API_URL = "https://architects-field-voice.onrender.com/chat";

    function appendMessage(sender, text) {
      const p = document.createElement("p");
      p.innerHTML = `<strong>${sender}:</strong> ${text}`;
      conversationDiv.appendChild(p);
      conversationDiv.scrollTop = conversationDiv.scrollHeight;
    }

    async function sendMessage(text) {
      appendMessage("You", text);
      userInput.value = "";

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });

        const data = await res.json();
        if (data.reply) {
          appendMessage("Unified Field", data.reply);

          // ðŸ”Š Play audio if backend sends base64 mp3
          if (data.audio) {
            const audio = new Audio("data:audio/mp3;base64," + data.audio);
            audio.play();
          }
        }
      } catch (err) {
        appendMessage("System", "Error contacting server.");
        console.error(err);
      }
    }

    sendBtn.addEventListener("click", () => {
      if (userInput.value.trim() !== "") {
        sendMessage(userInput.value.trim());
      }
    });

    userInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter" && userInput.value.trim() !== "") {
        sendMessage(userInput.value.trim());
      }
